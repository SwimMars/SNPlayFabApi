<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Secret Neighbor Exploits</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 40px;
    }
    input, button, select {
      margin: 5px;
      padding: 8px;
      font-size: 16px;
    }
    h2 {
      margin-top: 30px;
    }
    .section {
      margin-bottom: 40px;
    }
    .output {
      margin-top: 10px;
      padding: 10px;
      background: #f4f4f4;
      border: 1px solid #ccc;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>
  <h1>🎮 Secret Neighbor Exploits</h1>

  <div class="section">
    <h2>🔐 SessionTicket</h2>
    <input type="text" id="sessionTicketInput" placeholder="Paste your SessionTicket here" style="width: 400px;">
    <button onclick="setSessionTicket()">Set Token</button>
  </div>

  <div class="section">
    <h2>🛍️ Buy Skin/Emote</h2>
    <input type="text" id="itemId" placeholder="ItemId">
    <input type="number" id="price" placeholder="Price">
    <input type="text" id="currency" placeholder="VirtualCurrency">
    <button onclick="buySkinEmote()">Buy Skin/Emote</button>
  </div>

  <div class="section">
    <h2>🎁 Grant Coupons</h2>
    <button onclick="grantCoupons()">Grant Coupons</button>
  </div>

  <div class="section">
    <h2>📊 View Statistics</h2>
    <button onclick="viewStatistics()">View Statistics</button>
    <div id="statsOutput" class="output"></div>
  </div>

  <div class="section">
    <h2>🧑‍💻 Obtain Player ID With Username</h2>
    <input type="text" id="steamUsername" placeholder="Steam Username">
    <button onclick="getPlayFabId()">Obtain Player ID</button>
    <div id="playerIdOutput" class="output"></div>
  </div>

  <div class="section">
    <h2>🧠 Execute CloudScript: usefulDeed</h2>
    <button onclick="executeUsefulDeed()">Run usefulDeed</button>
  </div>

  <div class="section">
    <h2>🎮 Match Setup Functions</h2>
    <label>Room Type:</label>
    <select id="roomType">
      <option value="QUICK_GAME">QUICK_GAME</option>
      <option value="CUSTOM_GAME">CUSTOM_GAME</option>
    </select><br>
    <input type="text" id="playerId1" placeholder="Player ID 1">
    <input type="text" id="playerId2" placeholder="Player ID 2">
    <input type="text" id="playerId3" placeholder="Player ID 3">
    <input type="text" id="playerId4" placeholder="Player ID 4">
    <input type="text" id="playerId5" placeholder="Player ID 5">
    <input type="text" id="playerId6" placeholder="Player ID 6"><br>
    <button onclick="executeCloudScript('startNewMatch')">Start New Match</button>
    <button onclick="executeCloudScript('decideSpecialRole')">Decide Special Role</button>
    <button onclick="executeCloudScript('finishMatch')">Finish Match</button>
    <div id="cloudOutput" class="output"></div>
  </div>

  <div class="section">
    <h2>📄 How to Get Your SessionTicket with Requestly</h2>
    <ol>
      <li>Download the Requestly desktop app from <a href="https://docs.requestly.com/general/sessions/record-api-sessions" target="_blank">here</a>.</li>
      <li>Open Requestly and start recording network traffic.</li>
      <li>Log into your game or app using PlayFab.</li>
      <li>Find the request to <code>/Client/LoginWithSteam</code> or similar.</li>
      <li>Copy the <code>SessionTicket</code> or <code>X-Authorization</code> from the response body.</li>
      <li>Paste it into the field above and click "Set Token".</li>
    </ol>
  </div>

  <script>
    const titleId = "bdff1";
    let sessionTicket = null;

    function setSessionTicket() {
      sessionTicket = document.getElementById("sessionTicketInput").value.trim();
      alert("SessionTicket set successfully!");
    }

    async function buySkinEmote() {
      if (!sessionTicket) return alert("Please set your SessionTicket first.");
      const ItemId = document.getElementById("itemId").value.trim();
      const Price = parseInt(document.getElementById("price").value);
      const VirtualCurrency = document.getElementById("currency").value.trim();

      const res = await fetch(`https://${titleId}.playfabapi.com/Client/PurchaseItem`, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "X-Authorization": sessionTicket
        },
        body: JSON.stringify({ ItemId, Price, VirtualCurrency })
      });

      const data = await res.json();
      console.log("PurchaseItem response:", data);
      alert("PurchaseItem response logged to console.");
    }

    async function grantCoupons() {
      if (!sessionTicket) return alert("Please set your SessionTicket first.");

      const startRes = await fetch(`https://${titleId}.playfabapi.com/Client/StartPurchase`, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "X-Authorization": sessionTicket
        },
        body: JSON.stringify({
          StoreId: "steam_Shop_Currency",
          Items: [{ ItemId: "Currency_Bundle_PileOfCoupons", Quantity: 1 }]
        })
      });

      const startData = await startRes.json();
      const orderId = startData.data?.OrderId;
      if (!orderId) return alert("StartPurchase failed.");

      await fetch(`https://${titleId}.playfabapi.com/Client/PayForPurchase`, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "X-Authorization": sessionTicket
        },
        body: JSON.stringify({ OrderId: orderId, Currency: "RM", ProviderName: "Steam" })
      });

      await fetch(`https://${titleId}.playfabapi.com/Client/ConfirmPurchase`, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "X-Authorization": sessionTicket
        },
        body: JSON.stringify({ OrderId: orderId })
      });

      alert("GrantCoupons flow completed. Check console for details.");
    }

    async function viewStatistics() {
      if (!sessionTicket) return alert("Please set your SessionTicket first.");

      const res = await fetch(`https://${titleId}.playfabapi.com/Client/GetPlayerStatistics`, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "X-Authorization": sessionTicket
        },
        body: JSON.stringify({})
      });

      const data = await res.json();
      const stats = data.data?.Statistics || [];
      const output = stats.map(stat => `${stat.StatisticName}: ${stat.Value}`).join("\n");
      document.getElementById("statsOutput").textContent = output || "No statistics found.";
    }

    async function getPlayFabId() {
      const steamUsername = document.getElementById("steamUsername").value.trim();
      if (!steamUsername) return alert("Please enter a Steam username.");

      const res = await fetch(`https://${titleId}.playfabapi.com/Client/GetPlayFabIDsFromSteamNames`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ SteamNames: [steamUsername] })
      });

      const data = await res.json();
      const match = data.data?.SteamIdMappings?.[0];
      const output = match ? `PlayFabId for "${steamUsername}": ${match.PlayFabId}` : "No matching PlayFab ID found.";
      document.getElementById("playerIdOutput").textContent = output;
    }

    async function executeUsefulDeed() {
      if (!sessionTicket) return alert("Please set your SessionTicket first.");

      const res = await fetch(`https://${titleId}.playfabapi.com/Client/ExecuteCloudScript`, {
        method
